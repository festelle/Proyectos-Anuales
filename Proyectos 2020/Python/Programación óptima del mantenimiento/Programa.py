from gurobipy import *#ConjuntosJ = ["maquina1", "maquina2", "maquina3", "maquina4", "maquina5"]I = ["sillones_dentales", "intraorales", "extraorales", "esterilizacion"]T = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10,11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30]#parametrosBi = {"sillones_dentales": 3, "intraorales": 2, "extraorales": 1, "esterilizacion": 1}Tij = {"sillones_dentales": {"maquina1": 1, "maquina2": 1, "maquina3": 1, "maquina4": 1, "maquina5": 1},      "intraorales": {"maquina1": 1, "maquina2": 1, "maquina3": 1, "maquina4": 1, "maquina5": 1},      "extraorales": {"maquina1": 1, "maquina2": 1, "maquina3": 1, "maquina4": 1, "maquina5": 1},      "esterilizacion":{"maquina1": 1, "maquina2": 1, "maquina3": 1, "maquina4": 1, "maquina5": 1}}Lij = {"sillones_dentales": {"maquina1": 15, "maquina2": 15, "maquina3": 15, "maquina4": 15, "maquina5": 15},     "intraorales": {"maquina1": 25, "maquina2": 25, "maquina3": 25, "maquina4": 25, "maquina5": 25},     "extraorales": {"maquina1": 25, "maquina2": 25, "maquina3": 25, "maquina4": 25, "maquina5": 25},     "esterilizacion":{"maquina1": 7, "maquina2": 7, "maquina3": 7, "maquina4": 7, "maquina5": 7}}Ri = {"sillones_dentales": 5, "intraorales": 5, "extraorales": 5, "esterilizacion":5 }Cij = {"sillones_dentales": {"maquina1": 80000, "maquina2": 80000, "maquina3": 80000, "maquina4": 80000, "maquina5": 80000},     "intraorales": {"maquina1": 50000, "maquina2": 50000, "maquina3": 50000, "maquina4": 50000, "maquina5": 50000},     "extraorales": {"maquina1": 80000, "maquina2": 80000, "maquina3": 80000, "maquina4": 80000, "maquina5": 80000},     "esterilizacion": {"maquina1": 25000, "maquina2": 25000, "maquina3": 25000, "maquina4": 25000, "maquina5": 25000}}Dij = {"sillones_dentales": {"maquina1": 300, "maquina2": 300, "maquina3": 300, "maquina4": 300, "maquina5": 300},     "intraorales": {"maquina1": 800, "maquina2": 800, "maquina3": 800, "maquina4": 800, "maquina5": 800},     "extraorales": {"maquina1": 800, "maquina2": 800, "maquina3": 800, "maquina4": 800, "maquina5": 800},     "esterilizacion": {"maquina1": 200, "maquina2": 200, "maquina3": 200, "maquina4": 200, "maquina5": 200}}P = 2000000Sijt = {"sillones_dentales": {"maquina1": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina2": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina3": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina4": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina5": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24}},                "intraorales":        {"maquina1": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina2": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina3": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina4": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina5": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24}},                "extraorales":        {"maquina1": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina2": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina3": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina4": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina5": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24}},                "esterilizacion":     {"maquina1": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina2": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina3": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina4": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24},                                                            "maquina5": {1: 24, 2: 24,3: 24, 4: 24, 5: 24, 6: 24, 7: 24, 8: 24, 9: 24, 10: 24,                                           11: 24, 12: 24, 13: 24, 14: 24, 15: 24, 16: 24, 17: 24, 18: 24,19: 24,                                           20: 24, 21: 24, 22: 24, 23: 24, 24: 24, 25: 24, 26: 24, 27: 24, 28: 24,                                           29: 24, 30: 24}}}Pit = {"sillones_dentales": {1: 96, 2: 72,3: 102, 4: 114, 5: 120, 6: 89, 7: 86, 8: 95, 9: 71, 10: 90,                             11: 113, 12: 116, 13: 117, 14: 108, 15: 96, 16: 117, 17: 119, 18: 120,19: 99,                             20: 100, 21: 106, 22: 117, 23: 104, 24: 107, 25: 87, 26: 115, 27: 110, 28: 116,                             29: 114, 30: 104},              "intraorales": {1: 96, 2: 72,3: 102, 4: 114, 5: 120, 6: 89, 7: 86, 8: 95, 9: 71, 10: 90,                      11: 113, 12: 116, 13: 117, 14: 108, 15: 96, 16: 117, 17: 119, 18: 120,19: 99,                      20: 100, 21: 106, 22: 117, 23: 104, 24: 107, 25: 87, 26: 115, 27: 110, 28: 116,                      29: 114, 30: 104},              "extraorales": {1: 96, 2: 72,3: 102, 4: 114, 5: 120, 6: 89, 7: 86, 8: 95, 9: 71, 10: 90,                     11: 113, 12: 116, 13: 117, 14: 108, 15: 96, 16: 117, 17: 119, 18: 120,19: 99,                     20: 100, 21: 106, 22: 117, 23: 104, 24: 107, 25: 87, 26: 115, 27: 110, 28: 116,                     29: 114, 30: 104},              "esterilizacion": {1: 96, 2: 72,3: 102, 4: 114, 5: 120, 6: 89, 7: 86, 8: 95, 9: 71, 10: 90,                          11: 113, 12: 116, 13: 117, 14: 108, 15: 96, 16: 117, 17: 119, 18: 120,19: 99,                          20: 100, 21: 106, 22: 117, 23: 104, 24: 107, 25: 87, 26: 115, 27: 110, 28: 116,                          29: 114, 30: 104}}#variablesm= Model()m.addVar()Xijt = m.addVars(I,J,T,vtype=GRB.BINARY, name="Xijt")Zijt = m.addVars(I,J,T,vtype=GRB.BINARY, name="zijt")Wijt = m.addVars(I,J,T,vtype=GRB.BINARY, name="W")Bijt = m.addVars(I,J,T,vtype=GRB.INTEGER, name="personas atendidas")N_PACIENTES_ATENDIDOSit = m.addVars(I,T,vtype=GRB.INTEGER, name="Pacientes atendidos por tipo")Yijt = m.addVars(I,J,T,vtype=GRB.BINARY, name="DIA DE MANTENIMIENTO")m.update()#fofuncionobj = quicksum(Bijt[i,j,t] for j in J for i in I for t in T)#r1m.addConstr(quicksum((Yijt[i,j,t]*Cij[i][j]) for i in I for j in J for t in T) <= P, name="presupuesto")#r2m.addConstrs((quicksum(Wijt[i,j,t] for j in J)>=1 for i in I for t in T), name="1 maquina funcionando")#r3m.addConstrs((quicksum(Wijt[i,j,t] for t in T)<=((quicksum(Yijt[i,j,t] for t in T))+1)*Lij[i][j] for j in J for i in I for t in T), name="uso maquina")#r4m.addConstrs((quicksum(Bijt[i,j,t] for t in T)<=Dij[i][j]*              (quicksum(1-Wijt[i,j,t]-Xijt[i,j,t] for t in T)-((Tij[i][j]-1)*quicksum(Yijt[i,j,t] for t in T))+1) for i in I for j in J), name="uso maximo pacientes")#r5m.addConstrs((quicksum(Zijt[i,j,t] for t in T)==Tij[i][j]*quicksum(Yijt[i,j,t] for t in T) for i in I for j in J), name="dias mantenimiento")#r6m.addConstrs((Zijt[i,j,t]+Wijt[i,j,t]>=Yijt[l,k,t] for j in J for k in J if j != k if k != j for i in I for l in I if i != l if l != i for t in T), name="prioridad")#r8m.addConstrs((Bijt[i,j,t]<=Sijt[i][j][t]*Wijt[i,j,t] for t in T for i in I for j in J), name="maxima utilizacion maquina")#r11#am.addConstrs((1-Xijt[i,j,t]>=Zijt[i,j,t] for t in T for i in I for j in J), name="relacion variables a")#bm.addConstrs((1-Xijt[i,j,t]-Zijt[i,j,t]==Wijt[i,j,t] for t in T for i in I for j in J), name="relacion variables b")#cm.addConstrs((1-Xijt[i,j,t]>=Yijt[i,j,t] for t in T for i in I for j in J), name="relacion variables c")#dm.addConstrs((Zijt[i,j,t]>=Yijt[i,j,t] for t in T for i in I for j in J), name="relacion variables d")#em.addConstrs((1-Wijt[i,j,t]<=Zijt[i,j,t]+Yijt[i,j,t]+Xijt[i,j,t] for t in T for i in I for j in J), name="relacion variables e")#########r12m.addConstrs((quicksum(Bijt[i,j,t]*Wijt[i,j,t] for j in J)<=Pit[i][t] for j in J for t in T for i in I), name="reparticion pacientes")# Se agrega variable para mostrar el total de pacientes a atender cada día por tipo de máquinam.addConstrs((quicksum(Bijt[i,j,t]*Wijt[i,j,t]for j in J)==N_PACIENTES_ATENDIDOSit[i,t] for j in J for t in T for i in I), name="reparticion pacientes")#naturaleza_variablesm.addConstrs((Bijt[i,j,t]>=0 for t in T for i in I for j in J), name="naturaleza_variables")m.setObjective(funcionobj, GRB.MAXIMIZE)m.optimize()m.printAttr("X")print("\n-------------\n")##W: DIAS DE USO DE LA MÁQUINA##X: DIAS EN QUE LA MÁQUINA NO SE USA, NO NECESARIAMENTE LISTA DE ESPERA####     VARIABLE "DIA DE MANTENIMIENTO" DICE QUÉ DÍAS HAY QUE MANDAR A MANTENIMIENTO         ############     CADA MÁQUINA (ESTÁ COMO TIPO DE MÁQUINA, NÚMERO DE MÁQUINA, DÍA DE MANTENCIÓN)     ########        